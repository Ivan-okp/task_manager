Проект — REST API на FastAPI для управления пользователями и задачами. Архитектурно проект разделён на две части:

- Демонстрационная — позволяет просматривать, создавать, изменять и удалять всех пользователей и все задачи в системе (
  полный CRUD для пользователей и задач). Подходит для демонстрации функциональности и администрирования.
- Сервисная — предназначена для реального сценария использования: регистрация, авторизация/аутентификация (JWT), работа
  с собственной учётной записью (просмотр, обновление, удаление) и работа с задачами от имени аутентифицированного
  пользователя (CRUD задач только для собственного аккаунта).

Во всех сервисных эндпоинтах авторизация реализована через JWT access-токены.

Каждому эндпоинту соответствуют интеграционные параметризованные тесты; запуск всего тестового набора — через pytest.

Коротко:

- Запуск сервера локально: uvicorn src.my_project.main:app --reload
- Запуск тестов: pytest

Содержание README:

- Быстрый старт
- Среда и зависимости
- Перечень основных эндпоинтов
- Примеры запросов (регистрация, логин, использование JWT)
- Тестирование
- Настройки / переменные окружения
- Полезные заметки для разработки

Быстрый старт

1. Клонирование и установка зависимостей

- Клонируйте репозиторий
- Создайте виртуальное окружение и активируйте его:
  python -m venv venv
  . venv/bin/activate
- Установите зависимости:
  poetry install

2. Переменные окружения
   Проект не предусматривает прямое взаимодействие с переменными окружения, при необходимости их можно добавить.

3. Запуск приложения локально
   uvicorn src.myproject.main:app --reload

После запуска сервер по умолчанию доступен на http://127.0.0.1:8000 и автодокументация OpenAPI:

- Swagger UI: http://127.0.0.1:8000/docs
- ReDoc: http://127.0.0.1:8000/redoc

Основные возможности

Сервисная часть

- Регистрация нового пользователя
- Логин / получение JWT access token
- Получение и изменение профиля текущего пользователя
- Удаление своей учётной записи
- CRUD задач, принадлежащих аутентифицированному пользователю:
    - Создать задачу
    - Получить список своих задач
    - Получить конкретную задачу (по id или title) только если она принадлежит пользователю
    - Обновить задачу (по id или title) только если она принадлежит пользователю
    - Удалить задачу (по id или title) только если она принадлежит пользователю

Демонстрационная часть

- Просмотр всех пользователей
- Просмотр всех задач
- CRUD для пользователей и задач

Обзор эндпоинтов

Demo:

- Пользователи:
    - GET /users - Получить список всех пользователей
    - GET /users/{user_id} - Получить информацию о конкретном пользователе
    - POST /users - Создать нового пользователя
    - PUT /users/{user_id} - Обновить информацию о пользователе
    - DELETE /users/{user_id} - Удалить пользователя
    - Задачи:
        - GET /tasks - Получить список всех задач
        - GET /tasks/{task_id} - Получить информацию о конкретной задаче
        - POST /tasks - Создать новую задачу
        - PUT /tasks/{task_id} - Обновить информацию о задаче
        - DELETE /tasks/{task_id} - Удалить задачу

Service:

- Пользователи:
    - POST /service_user/create_user - Создать нового пользователя
    - POST /service_user/login - Регистрация для работы с задачами
    - PUT /service_user/change_user - Изменение учетной записи
    - DELETE /users/{user_id} - Обновить информацию о пользователе
    - DELETE /service_user/delete_user - Удалить пользователя
    - Задачи:
        - GET /service/get_all_tasks - Список всех задач пользователя
        - GET /service/get_specific_task - Получить информацию о конкретной задаче
        - POST /service/create_task - Создать новую задачу
        - PUT /service/update_task - Обновить информацию о задаче
        - DELETE /service/delete_task - Удалить задачу

Аутентификация (JWT)

1. Регистрация
   Пример запроса (curl):
   curl -X POST "http://127.0.0.1:8000/service_user/create_user" -H "Content-Type: application/json" -d '{
   "name": "test user",
   "email": "test@mail.com",
   "password": "123456789"
   }'

2. Логин
   Пример запроса (curl):
   curl -X POST "http://127.0.0.1:8000/service_user/login" -d "username=test@mail.com&password=123456789"

Пример успешного ответа:
{
"access_token": "<JWT_ACCESS_TOKEN>",
"token_type": "Bearer"
}

3. Использование токена
   Добавьте заголовок Authorization ко всем защищённым запросам:
   Authorization: Bearer <JWT_ACCESS_TOKEN>

Пример получения своих задач:
curl -H "Authorization: Bearer <JWT_ACCESS_TOKEN>" "http://127.0.0.1:8000/service/get_all_tasks"

Тестирование

- Все интеграционные/сервисные тесты написаны и параметризованы. Для запуска тестов:
  pytest

- Тесты проверяют:
    - корректность работы CRUD операций (и для demo, и для service частей),
    - корректность поведения при валидационных ошибках,
    - поведение аутентификации/авторизации по JWT,
    - частично — бизнес-логику владения задачами (пользователь не может изменять чужие задачи в service-части).

Примечания:

- В тестах динамические поля (токены, хеши паролей) обычно не сравниваются как статические строки. Тесты проверяют
  наличие токена и его структуру/тип.
- Тесты параметризованы и предполагают предсказуемое начальное состояние тестовой БД; при изменении фикстур или порядка
  создания сущностей необходимо обновлять ожидаемые значения (id, поля и т.д.).

Полезные команды

- Запуск сервера в режиме разработки:
  uvicorn src.myproject.main:app --reload
- Запуск тестов:
  pytest
- Открыть автодокументацию:
  http://127.0.0.1:8000/docs

Контрибьюция

- Pull requests приветствуются.
- Описывайте изменения в README и/или в тестах при изменении публичных контрактов API.
- Добавляйте/обновляйте тесты при внесении изменений в бизнес-логику или валидацию.

Лицензия
MIT
